/*!
 * Copyright (c) 2012 - 2020, Anaconda, Inc., and Bokeh Contributors
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 * 
 * Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 * 
 * Neither the name of Anaconda nor the names of any contributors
 * may be used to endorse or promote products derived from this software
 * without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 * THE POSSIBILITY OF SUCH DAMAGE.
*/
(function(root, factory) {
  factory(root["Bokeh"], undefined);
})(this, function(Bokeh, version) {
  var define;
  return (function(modules, entry, aliases, externals) {
    const bokeh = typeof Bokeh !== "undefined" && (version != null ? Bokeh[version] : Bokeh);
    if (bokeh != null) {
      return bokeh.register_plugin(modules, entry, aliases);
    } else {
      throw new Error("Cannot find Bokeh " + version + ". You have to load it prior to loading plugins.");
    }
  })
({
"e1b43c024c": function _(e,a,m){Object.defineProperty(m,"__esModule",{value:!0});var t=e("4f96ca39c4");m.ImageTimestamp=t.ImageTimestamp},
"4f96ca39c4": function _(e,a,t){Object.defineProperty(t,"__esModule",{value:!0});const i=e("f9514df777"),s=e("@bokehjs/models/mappers/color_mapper"),m=e("@bokehjs/models/mappers/linear_color_mapper");class r extends i.ImageTimestampBaseView{connect_signals(){super.connect_signals(),this.connect(this.model.color_mapper.change,()=>this._update_image())}initialize(){super.initialize(),window.requestAnimationFrame(this._frame)}_frame(e){console.log(e)}_update_image(){null!=this.image_data&&(this._set_data(null),this.renderer.plot_view.request_render())}_flat_img_to_buf8(e){return this.model.color_mapper.rgba_mapper.v_compute(e)}}t.ImageView=r,r.__name__="ImageView";class o extends i.ImageTimestampBase{constructor(e){super(e)}static init_ImageTimestamp(){this.prototype.default_view=r,this.define(({Ref:e})=>({color_mapper:[e(s.ColorMapper),()=>new m.LinearColorMapper({palette:["#000000","#252525","#525252","#737373","#969696","#bdbdbd","#d9d9d9","#f0f0f0","#ffffff"]})]}))}}t.ImageTimestamp=o,o.__name__="ImageTimestamp",o.init_ImageTimestamp()},
"f9514df777": function _(e,t,s){Object.defineProperty(s,"__esModule",{value:!0});const i=e("tslib"),a=e("@bokehjs/models/glyphs/xy_glyph"),h=e("@bokehjs/core/types"),r=i.__importStar(e("@bokehjs/core/properties")),n=e("@bokehjs/models/selections/selection"),_=e("@bokehjs/core/util/array"),d=e("@bokehjs/core/util/ndarray"),l=e("@bokehjs/core/util/assert");class o extends a.XYGlyphView{constructor(e){super(e)}connect_signals(){super.connect_signals(),this.connect(this.model.properties.global_alpha.change,()=>this.renderer.request_render()),this.connect(this.model.properties.time_stamp.change,()=>{this.renderer.request_render()})}_render(e,t,{image_data:s,sx:i,sy:a,sw:h,sh:r}){const n=e.getImageSmoothingEnabled();e.setImageSmoothingEnabled(!1),e.globalAlpha=this.model.global_alpha;for(const n of t){if(null==s[n]||isNaN(i[n]+a[n]+h[n]+r[n]))continue;const t=a[n];e.translate(0,t),e.scale(1,-1),e.translate(0,-t),e.drawImage(s[n],0|i[n],0|a[n],h[n],r[n]),e.translate(0,t),e.scale(1,-1),e.translate(0,-t)}e.setImageSmoothingEnabled(n)}_set_data(e){console.log("_set_data"),this._set_width_heigh_data();for(let t=0,s=this._image.length;t<s;t++){if(null!=e&&e.indexOf(t)<0)continue;const s=this._image[t](this.model.time_stamp);let i;d.is_NDArray(s)?(l.assert(2==s.dimension,"expected a 2D array"),i=s,this._height[t]=s.shape[0],this._width[t]=s.shape[1]):(i=_.concat(s),this._height[t]=s.length,this._width[t]=s[0].length);const a=this._flat_img_to_buf8(i);this._set_image_data_from_buffer(t,a)}}_index_data(e){const{data_size:t}=this;for(let s=0;s<t;s++){const[t,i,a,h]=this._lrtb(s);isNaN(t+i+a+h)||!isFinite(t+i+a+h)?e.add_empty():e.add(t,h,i,a)}}_lrtb(e){const t=this.renderer.xscale.source_range,s=this._x[e],i=t.is_reversed?s-this._dw[e]:s+this._dw[e],a=this.renderer.yscale.source_range,h=this._y[e],r=a.is_reversed?h-this._dh[e]:h+this._dh[e],[n,_]=s<i?[s,i]:[i,s],[d,l]=h<r?[h,r]:[r,h];return[n,_,l,d]}_set_width_heigh_data(){null!=this.image_data&&this.image_data.length==this._image.length||(this.image_data=new Array(this._image.length)),null!=this._width&&this._width.length==this._image.length||(this._width=new h.NumberArray(this._image.length)),null!=this._height&&this._height.length==this._image.length||(this._height=new h.NumberArray(this._image.length))}_get_or_create_canvas(e){const t=this.image_data[e];if(null!=t&&t.width==this._width[e]&&t.height==this._height[e])return t;{const t=document.createElement("canvas");return t.width=this._width[e],t.height=this._height[e],t}}_set_image_data_from_buffer(e,t){const s=this._get_or_create_canvas(e),i=s.getContext("2d"),a=i.getImageData(0,0,this._width[e],this._height[e]);a.data.set(t),i.putImageData(a,0,0),this.image_data[e]=s}_map_data(){switch(this.model.properties.dw.units){case"data":this.sw=this.sdist(this.renderer.xscale,this._x,this._dw,"edge",this.model.dilate);break;case"screen":this.sw=this._dw}switch(this.model.properties.dh.units){case"data":this.sh=this.sdist(this.renderer.yscale,this._y,this._dh,"edge",this.model.dilate);break;case"screen":this.sh=this._dh}}_image_index(e,t,s){const[i,a,h,r]=this._lrtb(e),n=this._width[e],_=this._height[e],d=(a-i)/n,l=(h-r)/_;let o=Math.floor((t-i)/d),c=Math.floor((s-r)/l);return this.renderer.xscale.source_range.is_reversed&&(o=n-o-1),this.renderer.yscale.source_range.is_reversed&&(c=_-c-1),{index:e,dim1:o,dim2:c,flat_index:c*n+o}}_hit_point(e){const{sx:t,sy:s}=e,i=this.renderer.xscale.invert(t),a=this.renderer.yscale.invert(s),h=this.index.indices({x0:i,x1:i,y0:a,y1:a}),r=new n.Selection;for(const e of h)t!=1/0&&s!=1/0&&r.image_indices.push(this._image_index(e,i,a));return r}}s.ImageTimestampBaseView=o,o.__name__="ImageTimestampBaseView";class c extends a.XYGlyph{constructor(e){super(e)}static init_ImageTimestampBase(){this.define({image:[r.NDArraySpec],dw:[r.DistanceSpec],dh:[r.DistanceSpec],dilate:[r.Boolean,!1],global_alpha:[r.Number,1],time_stamp:[r.Number,1]})}}s.ImageTimestampBase=c,c.__name__="ImageTimestampBase",c.init_ImageTimestampBase()},
}, "e1b43c024c", {"index":"e1b43c024c","image_timestamp":"4f96ca39c4","image_timestamp_base":"f9514df777"}, {});
})

