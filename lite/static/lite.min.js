!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);let n=function(e,t,r){this.figure=e,void 0===r&&(r=new Bokeh.ColumnDataSource({data:{x:[],y:[],dw:[],dh:[],image:[],level:[],units:[]}})),this.source=r;const n=e.image({x:{field:"x"},y:{field:"y"},dw:{field:"dw"},dh:{field:"dh"},image:{field:"image"},source:this.source,color_mapper:t}),o=new Bokeh.HoverTool({renderers:[n],tooltips:"Value: @image @units"});e.add_tools(o),this.url="/tiles/dataset/time/{Z}/{X}/{Y}",fetch("/google_limits").then(e=>e.json()).then(e=>{this.limits=e}),this.tileCache={},this.imageCache={};let i=this.figure.x_range;i.connect(i.properties.start.change,()=>{this.render()})};n.prototype.setURL=function(e){if(e===this.url)return;this.url=e;let t=Object.keys(this.source.data).reduce((e,t)=>(e[t]=[],e),{});this.source.data=t,this.source.change.emit(),this.tileCache={},this.render()},n.prototype.render=function(){if(void 0===this.limits)return;let e=this.figure.x_range,t=this.figure.y_range,r=o(e,t,this.limits),n={remote:[],local:[]};for(let e=0;e<r.length;e++){let t=r[e],o=this.url.replace("{Z}",t.z).replace("{X}",t.x).replace("{Y}",t.y);o in this.tileCache||(this.tileCache[o]=!0,o in this.imageCache?n.local.push(o):n.remote.push(o))}let i=n.local.map(e=>this.imageCache[e]);i.length>0&&this._addImages(i),n.remote.forEach(e=>{fetch(e).then(e=>e.json()).then(t=>{this.imageCache[e]=t,this._addImage(t)})})},n.prototype._addImages=function(e){let t=this.source,r=this.splitImages(t.data).concat(e);r=r.sort((e,t)=>e.level[0]-t.level[0]);let n=this.mergeImages(r);t.data=n,t.change.emit()},n.prototype._addImage=function(e){let t=this.source,r=Object.keys(e).reduce((r,n)=>(r[n]=t.data[n].concat(e[n]),r),{}),n=this.splitImages(r);n=n.sort((e,t)=>e.level[0]-t.level[0]);let o=this.mergeImages(n);t.data=o,t.change.emit()},n.prototype.splitImages=function(e){return Object.keys(e).reduce((t,r)=>(e[r].forEach((e,n)=>{t[n]=t[n]||{},t[n][r]=[e]}),t),[])},n.prototype.mergeImages=function(e){return e.reduce((e,t)=>(Object.keys(t).forEach(r=>{e[r]=e[r]||[],e[r]=e[r].concat(t[r])}),e),{})};let o=function(e,t,r){let n=i(r.x[0],r.x[1],0,256),o=i(r.y[0],r.y[1],0,256),c={x:{start:n(e.start),end:n(e.end)},y:{start:o(t.start),end:o(t.end)}},u=l(c)+2,f={x:{start:s(a(c.x.start,u)),end:s(a(c.x.end,u))},y:{start:s(a(c.y.start,u)),end:s(a(c.y.end,u))}},h=[];for(let e=f.x.start;e<=f.x.end;e++)for(let t=f.y.start;t<=f.y.end;t++)h.push({z:u,x:e,y:t});return h},i=function(e,t,r,n){return function(o){return(n-r)*(o-e)/(t-e)}},a=function(e,t){return Math.floor(e*2**t)},s=function(e){return Math.floor(e/256)},l=function(e){let t=e.x.end-e.x.start,r=e.y.end-e.y.start,n=Math.min(t,r);return Math.floor(Math.log2(256/n))};function c(e,t,r){if(!g(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===e)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");n&&y(n),o&&m(o);var i={type:"Feature"};return o&&(i.id=o),n&&(i.bbox=n),i.properties=t||{},i.geometry=e,i}function u(e,t,r){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!p(e[0])||!p(e[1]))throw new Error("coordinates must contain numbers");return c({type:"Point",coordinates:e},t,r)}function f(e,t,r){if(!e)throw new Error("coordinates is required");if(e.length<2)throw new Error("coordinates must be an array of two or more positions");if(!p(e[0][1])||!p(e[0][1]))throw new Error("coordinates must contain numbers");return c({type:"LineString",coordinates:e},t,r)}function h(e,t){if(!g(t=t||{}))throw new Error("options is invalid");var r=t.bbox,n=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");r&&y(r),n&&m(n);var o={type:"FeatureCollection"};return n&&(o.id=n),r&&(o.bbox=r),o.features=e,o}function d(e,t,r){if(!e)throw new Error("coordinates is required");return c({type:"MultiLineString",coordinates:e},t,r)}function p(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function g(e){return!!e&&e.constructor===Object}function y(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!p(e))throw new Error("bbox must only contain numbers")}))}function m(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}function b(e,t,r){if(null!==e)for(var n,o,i,a,s,l,c,u,f=0,h=0,d=e.type,p="FeatureCollection"===d,g="Feature"===d,y=p?e.features.length:1,m=0;m<y;m++){s=(u=!!(c=p?e.features[m].geometry:g?e.geometry:e)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var E=0;E<s;E++){var v=0,w=0;if(null!==(a=u?c.geometries[E]:c)){l=a.coordinates;var _=a.type;switch(f=!r||"Polygon"!==_&&"MultiPolygon"!==_?0:1,_){case null:break;case"Point":t(l,h,m,v,w),h++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++)t(l[n],h,m,v,w),h++,"MultiPoint"===_&&v++;"LineString"===_&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(o=0;o<l[n].length-f;o++)t(l[n][o],h,m,v,w),h++;"MultiLineString"===_&&v++,"Polygon"===_&&w++}"Polygon"===_&&v++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for("MultiPolygon"===_&&(w=0),o=0;o<l[n].length;o++){for(i=0;i<l[n][o].length-f;i++)t(l[n][o][i],h,m,v,w),h++;w++}v++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)b(a.geometries[n],t,r);break;default:throw new Error("Unknown Geometry Type")}}}}}function E(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length;r++)t(e.features[r],r)}function v(e){var t={type:"Feature"};return Object.keys(e).forEach((function(r){switch(r){case"type":case"properties":case"geometry":return;default:t[r]=e[r]}})),t.properties=function e(t){var r={};return t?(Object.keys(t).forEach((function(n){var o=t[n];"object"==typeof o?null===o?r[n]=null:o.length?r[n]=o.map((function(e){return e})):r[n]=e(o):r[n]=o})),r):r}(e.properties),t.geometry=w(e.geometry),t}function w(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),"GeometryCollection"===e.type?(t.geometries=e.geometries.map((function(e){return w(e)})),t):(t.coordinates=function e(t){if("object"!=typeof t[0])return t.slice();return t.map((function(t){return e(t)}))}(e.coordinates),t)}var _=function(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return v(e);case"FeatureCollection":return function(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach((function(r){switch(r){case"type":case"features":return;default:t[r]=e[r]}})),t.features=e.features.map((function(e){return v(e)})),t}(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return w(e);default:throw new Error("unknown GeoJSON type")}};function S(e,t,r){if(!g(r=r||{}))throw new Error("options is invalid");var n=r.mutate;if(!e)throw new Error("geojson is required");return Array.isArray(e)&&p(e[0])?e="mercator"===t?T(e):A(e):(!0!==n&&(e=_(e)),b(e,(function(e){var r="mercator"===t?T(e):A(e);e[0]=r[0],e[1]=r[1]}))),e}function T(e){var t,r=Math.PI/180,n=6378137,o=20037508.342789244,i=[n*(Math.abs(e[0])<=180?e[0]:e[0]-360*((t=e[0])<0?-1:t>0?1:0))*r,n*Math.log(Math.tan(.25*Math.PI+.5*e[1]*r))];return i[0]>o&&(i[0]=o),i[0]<-o&&(i[0]=-o),i[1]>o&&(i[1]=o),i[1]<-o&&(i[1]=-o),i}function A(e){var t=180/Math.PI,r=6378137;return[e[0]*t/r,(.5*Math.PI-2*Math.atan(Math.exp(-e[1]/r)))*t]}var M=function(e){var t=[1/0,1/0,-1/0,-1/0];return b(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t};function P(e){if(!e)throw new Error("obj is required");var t;if(e.length?t=e:e.coordinates?t=e.coordinates:e.geometry&&e.geometry.coordinates&&(t=e.geometry.coordinates),t)return function e(t){if(t.length>1&&p(t[0])&&p(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return e(t[0]);throw new Error("coordinates must only contain numbers")}(t),t;throw new Error("No valid coordinates")}function x(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0;n<e.features.length;n++){var o=e.features[n];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!o.geometry||o.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+o.geometry.type)}}
/**
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 */
var k={successCallback:null,verbose:!1},I={};function j(e,t,r){r=r||{};for(var n=Object.keys(k),o=0;o<n.length;o++){var i=n[o],a=r[i];a=null!=a?a:k[i],I[i]=a}I.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+t);var s=function(e){var t=[],r=0;e.rows,e.cols;return e.cells.forEach((function(n,o){n.forEach((function(n,i){if(void 0!==n&&(5!==(h=n).cval&&10!==h.cval)&&!O(n)){var a=function(e,t,r){var n,o,i,a=e.length,s=[],l=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],c=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],u=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],f=(e[t][r],e[t][r]),h=f.cval,d=N(f,i=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"][h]);s.push([r+d[0],t+d[1]]),d=N(f,i=u[h]),s.push([r+d[0],t+d[1]]),L(f);var p=r+l[h],g=t+c[h],y=h;for(;p>=0&&g>=0&&g<a&&(p!=r||g!=t)&&void 0!==(f=e[g][p]);){if(0===(h=f.cval)||15===h)return{path:s,info:"mergeable"};i=u[h],n=l[h],o=c[h],5!==h&&10!==h||(5===h?f.flipped?-1===c[y]?(i="left",n=-1,o=0):(i="right",n=1,o=0):-1===l[y]&&(i="bottom",n=0,o=-1):10===h&&(f.flipped?-1===l[y]?(i="top",n=0,o=1):(i="bottom",n=0,o=-1):1===c[y]&&(i="left",n=-1,o=0))),d=N(f,i),s.push([p+d[0],g+d[1]]),L(f),p+=n,g+=o,y=h}return{path:s,info:"closed"}}(e.cells,o,i),s=!1;if("mergeable"===a.info)for(var l=a.path[a.path.length-1][0],c=a.path[a.path.length-1][1],u=r-1;u>=0;u--)if(Math.abs(t[u][0][0]-l)<=1e-7&&Math.abs(t[u][0][1]-c)<=1e-7){for(var f=a.path.length-2;f>=0;--f)t[u].unshift(a.path[f]);s=!0;break}s||(t[r++]=a.path)}var h}))})),t}(function(e,t){for(var r=e.length-1,n=e[0].length-1,o={rows:r,cols:n,cells:[]},i=0;i<r;++i){o.cells[i]=[];for(var a=0;a<n;++a){var s=0,l=e[i+1][a],c=e[i+1][a+1],u=e[i][a+1],f=e[i][a];if(!(isNaN(l)||isNaN(c)||isNaN(u)||isNaN(f))){s|=l>=t?8:0,s|=c>=t?4:0,s|=u>=t?2:0;var h,d,p,g,y=!1;if(5===(s|=f>=t?1:0)||10===s){var m=(l+c+u+f)/4;5===s&&m<t?(s=10,y=!0):10===s&&m<t&&(s=5,y=!0)}if(0!==s&&15!==s)h=d=p=g=.5,1===s?(p=1-C(t,l,f),d=1-C(t,u,f)):2===s?(d=C(t,f,u),g=1-C(t,c,u)):3===s?(p=1-C(t,l,f),g=1-C(t,c,u)):4===s?(h=C(t,l,c),g=C(t,u,c)):5===s?(h=C(t,l,c),g=C(t,u,c),d=1-C(t,u,f),p=1-C(t,l,f)):6===s?(d=C(t,f,u),h=C(t,l,c)):7===s?(p=1-C(t,l,f),h=C(t,l,c)):8===s?(p=C(t,f,l),h=1-C(t,c,l)):9===s?(d=1-C(t,u,f),h=1-C(t,c,l)):10===s?(h=1-C(t,c,l),g=1-C(t,c,u),d=C(t,f,u),p=C(t,f,l)):11===s?(h=1-C(t,c,l),g=1-C(t,c,u)):12===s?(p=C(t,f,l),g=C(t,u,c)):13===s?(d=1-C(t,u,f),g=C(t,u,c)):14===s?(p=C(t,f,l),d=C(t,f,u)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+s),o.cells[i][a]={cval:s,flipped:y,top:h,right:g,bottom:d,left:p}}}}return o}(e,t));return"function"==typeof I.successCallback&&I.successCallback(s),s}function C(e,t,r){return(e-t)/(r-t)}function O(e){return 0===e.cval||15===e.cval}function L(e){O(e)||5===e.cval||10===e.cval||(e.cval=15)}function N(e,t){return"top"===t?[e.top,1]:"bottom"===t?[e.bottom,0]:"right"===t?[1,e.right]:"left"===t?[0,e.left]:void 0}function B(e,t){if(!g(t=t||{}))throw new Error("options is invalid");var r=t.zProperty||"elevation",n=t.flip,o=t.flags;x(e,"Point","input must contain Points");for(var i=function(e,t){var r={};return E(e,(function(e){var t=P(e)[1];r[t]||(r[t]=[]),r[t].push(e)})),Object.keys(r).map((function(e){return r[e].sort((function(e,t){return P(e)[0]-P(t)[0]}))})).sort((function(e,r){return t?P(e[0])[1]-P(r[0])[1]:P(r[0])[1]-P(e[0])[1]}))}(e,n),a=[],s=0;s<i.length;s++){for(var l=i[s],c=[],u=0;u<l.length;u++){var f=l[u];f.properties[r]?c.push(f.properties[r]):c.push(0),!0===o&&(f.properties.matrixPosition=[s,u])}a.push(c)}return a}var F=function(e,t,r){if(!g(r=r||{}))throw new Error("options is invalid");var n=r.zProperty||"elevation",o=r.commonProperties||{},i=r.breaksProperties||[];if(x(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks must be an Array");if(!g(o))throw new Error("commonProperties must be an Object");if(!Array.isArray(i))throw new Error("breaksProperties must be an Array");var a=B(e,{zProperty:n,flip:!0});return h(function(e,t,r){var n=M(r),o=n[2]-n[0],i=n[3]-n[1],a=n[0],s=n[1],l=t[0].length-1,c=t.length-1,u=o/l,f=i/c,h=function(e){e[0]=e[0]*u+a,e[1]=e[1]*f+s};return e.forEach((function(e){b(e,h)})),e}(function(e,t,r,n,o){for(var i=[],a=1;a<t.length;a++){var s=+t[a],l=Object.assign({},n,o[a]);l[r]=s;var c=d(j(e,s),l);i.push(c)}return i}(a,t,n,o,i),a,e))};const D=function(e){let t=h([f([[0,0],[0,0]])]),r=JSON.stringify(t);this.source=new Bokeh.GeoJSONDataSource({geojson:r}),this.figure=e,this.figure.multi_line({xs:{field:"xs"},ys:{field:"ys"},line_color:"gray",source:this.source})};D.prototype.renderFeature=function(e,t){var r;e=S(e,"mercator",r);let n=F(e,t,{zProperty:"value"});n.features=n.features.concat().filter(e=>e.geometry.coordinates.length>0),n.features.length>0&&(this.source.geojson=JSON.stringify(n),this.source.change.emit())};let q={Antique:"https://cartocdn_d.global.ssl.fastly.net/base-antique/{Z}/{X}/{Y}.png","Midnight Commander":"https://cartocdn_d.global.ssl.fastly.net/base-midnight/{Z}/{X}/{Y}.png","ESRI Nat Geo":"https://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{Z}/{Y}/{X}",Voyager:"https://d.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{Z}/{X}/{Y}.png"};let X=e=>({type:"SET_PALETTE",payload:e}),R=e=>({type:"SET_PALETTE_NAME",payload:e}),G=e=>({type:"SET_PALETTE_NUMBER",payload:e}),U=e=>({type:"SET_TIME_INDEX",payload:e}),Y=(e="",t)=>{switch(t.type){case"SET_DATASET":return Object.assign({},e,{dataset:t.payload});case"SET_DATASETS":return Object.assign({},e,{datasets:t.payload});case"SET_URL":return Object.assign({},e,{url:t.payload});case"SET_PALETTE":return Object.assign({},e,{palette:t.payload});case"SET_PALETTES":return Object.assign({},e,{palettes:t.payload});case"SET_PALETTE_NAME":return Object.assign({},e,{palette_name:t.payload});case"SET_PALETTE_NAMES":return Object.assign({},e,{palette_names:t.payload});case"SET_PALETTE_NUMBER":return Object.assign({},e,{palette_number:t.payload});case"SET_PALETTE_NUMBERS":return Object.assign({},e,{palette_numbers:t.payload});case"SET_PLAYING":return Object.assign({},e,{playing:t.payload});case"SET_LIMITS":return Object.assign({},e,{limits:t.payload});case"SET_TIMES":return Object.assign({},e,{times:t.payload});case"SET_TIME_INDEX":return Object.assign({},e,{time_index:t.payload});case"FETCH_IMAGE":return Object.assign({},e,{is_fetching:!0,image_url:t.payload});case"FETCH_IMAGE_SUCCESS":return Object.assign({},e,{is_fetching:!1});default:return e}},Z=e=>e=>t=>{e(t)},z=e=>t=>r=>{if("NEXT_TIME_INDEX"===r.type){let r=e.getState();if(void 0===r.time_index)return;if(void 0===r.times)return;let n=H(r.time_index+1,r.times.length),o=U(n);t(o)}else if("PREVIOUS_TIME_INDEX"===r.type){let r=e.getState();if(void 0===r.time_index)return;if(void 0===r.times)return;let n=H(r.time_index-1,r.times.length),o=U(n);t(o)}else t(r)},W=e=>t=>r=>{if("SET_PALETTE_NAME"==r.type){let t=r.payload,n=e.getState();if(void 0!==n.palettes){let r=n.palettes.filter(e=>e.name==t).map(e=>parseInt(e.number)).concat().sort((e,t)=>e-t),o={type:"SET_PALETTE_NUMBERS",payload:r};e.dispatch(o)}}else if("SET_PALETTE_NUMBER"==r.type){let t=e.getState(),n=t.palette_name,o=r.payload;if(void 0!==t.palettes){let r=V(t.palettes,n,o);if(r.length>0){let t=X(r[0].palette);e.dispatch(t)}}}else if("SET_PALETTES"==r.type){t(r),t(R("Blues")),t(G(256));let e=V(r.payload,"Blues",256);if(e.length>0){let r=X(e[0].palette);t(r)}return}return t(r)},J=e=>e=>t=>{if(e(t),"SET_DATASETS"==t.type){let r=t.payload[0];e((e=>({type:"SET_DATASET",payload:e}))(r))}},H=function(e,t){return(e%t+t)%t},V=function(e,t,r){return e.filter(e=>e.name===t).filter(e=>parseInt(e.number)===parseInt(r))};function $(e,t){this.figure=e,this.source=new Bokeh.ColumnDataSource({data:{xs:[[]],ys:[[]]}}),this.figure.multi_line({xs:{field:"xs"},ys:{field:"ys"},line_color:t,source:this.source})}function K(e){this.el=e}function Q(e){this.button=document.createElement("button"),this.button.classList.add("lite-btn","play-btn"),this.i=document.createElement("i"),this.i.classList.add("fas","fa-play"),this.button.appendChild(this.i),this.button.onclick=e.onClick,this.el=this.button}function ee(e){let t,r;t=document.createElement("button"),t.classList.add("lite-btn","previous-btn"),t.onclick=e.onClick,r=document.createElement("i"),r.classList.add("fas","fa-angle-left"),t.appendChild(r),this.el=t}function te(e){let t,r;t=document.createElement("button"),t.classList.add("lite-btn","next-btn"),t.onclick=e.onClick,r=document.createElement("i"),r.classList.add("fas","fa-angle-right"),t.appendChild(r),this.el=t}window.main=function(){let e=new Bokeh.Range1d({start:0,end:1e6}),t=new Bokeh.Range1d({start:0,end:1e6}),r=Bokeh.Plotting.figure({x_range:e,y_range:t,sizing_mode:"stretch_both"});r.xaxis[0].visible=!1,r.yaxis[0].visible=!1,r.toolbar_location=null,r.min_border=0,r.select_one(Bokeh.WheelZoomTool).active=!0;let o=new Bokeh.WMTSTileSource({url:"https://cartocdn_d.global.ssl.fastly.net/base-antique/{Z}/{X}/{Y}.png"}),i=new Bokeh.TileRenderer({tile_source:o});r.renderers=r.renderers.concat(i),Bokeh.Plotting.show(r,"#map-figure");let a=Redux.createStore(Y,Redux.applyMiddleware(Z,z,W,J));a.subscribe(()=>{let e=a.getState();void 0!==e.url&&(o.url=e.url)}),fetch("./palettes").then(e=>e.json()).then(e=>{let t={type:"SET_PALETTES",payload:e};return a.dispatch(t),e}).then(e=>{let t=e.map(e=>e.name);return Array.from(new Set(t)).concat().sort()}).then(e=>{let t={type:"SET_PALETTE_NAMES",payload:e};a.dispatch(t)});let s=new Bokeh.Widgets.Select({options:Object.keys(q)});s.connect(s.properties.value.change,()=>{a.dispatch({type:"SET_URL",payload:q[s.value]})}),Bokeh.Plotting.show(s,"#tile-url-select");let l=new Bokeh.Widgets.Select({options:[]});l.connect(l.properties.value.change,()=>{a.dispatch({type:"SET_DATASET",payload:l.value})}),Bokeh.Plotting.show(l,"#select"),a.subscribe(()=>{let e=a.getState();void 0!==e.datasets&&void 0!==e.dataset&&(l.options=e.datasets,l.value=e.dataset)}),fetch("./datasets").then(e=>e.json()).then(e=>{a.dispatch({type:"SET_DATASETS",payload:e.names})});let c=new Bokeh.Widgets.Select({options:[]});a.subscribe(()=>{let e=a.getState();void 0!==e.palette_names&&(c.options=e.palette_names)}),c.connect(c.properties.value.change,()=>{let e=R(c.value);a.dispatch(e)}),Bokeh.Plotting.show(c,"#palette-select");let f=new Bokeh.Widgets.Select({options:[]});a.subscribe(()=>{let e=a.getState();if(void 0!==e.palette_numbers){let t=e.palette_numbers.map(e=>e.toString());f.options=t}}),f.connect(f.properties.value.change,()=>{let e=G(f.value);a.dispatch(e)}),Bokeh.Plotting.show(f,"#palette-number-select");let d=new Bokeh.LinearColorMapper({low:200,high:300,palette:["#440154","#208F8C","#FDE724"],nan_color:"rgba(0,0,0,0)"});a.subscribe(()=>{let e=a.getState();void 0!==e.palette&&(d.palette=e.palette),void 0!==e.limits&&(d.low=e.limits.low,d.high=e.limits.high)});let p=new n(r,d);a.subscribe(()=>{let e=a.getState();if(void 0===e.dataset)return;if(void 0===e.time_index)return;if(void 0===e.times)return;let t=e.times[e.time_index],r=`./tiles/${e.dataset}/${t}/{Z}/{X}/{Y}`;p.setURL(r)});let g=new D(r);a.subscribe(()=>{let e=a.getState();if(void 0===e.time_index)return;if(void 0===e.times)return;if(void 0===e.dataset)return;let t=e.times[e.time_index],r=`./points/${e.dataset}/${t}`;fetch(r).then(e=>e.json()).then(e=>{let t=e.coords.latitude.data,r=e.coords.longitude.data,n=e.data,o=[];for(let e=0;e<t.length;e++)for(let i=0;i<r.length;i++){let a=u([r[i],t[e]],{value:n[e][i]});o.push(a)}return h(o)}).then(e=>{g.renderFeature(e,[280,290,300])})});let y=new K(document.getElementById("title-text"));a.subscribe(()=>{let e=a.getState();if(void 0===e.time_index)return;if(void 0===e.times)return;let t=new Date(e.times[e.time_index]);y.render(t.toUTCString())}),a.dispatch(U(0)),fetch("./datasets/EIDA50/times?limit=10").then(e=>e.json()).then(e=>{let t={type:"SET_TIMES",payload:e};a.dispatch(t)});let m=()=>{let e=a.getState();if(!e.is_fetching&&e.playing){let e={type:"NEXT_TIME_INDEX"};a.dispatch(e)}},b=document.getElementById("controls"),E=document.createElement("div");E.classList.add("btn-row"),b.appendChild(E);let v=new ee({onClick:()=>{let e={type:"PREVIOUS_TIME_INDEX"};a.dispatch(e)}});E.appendChild(v.el);let w=new Q({onClick:function(){let e;e=!a.getState().playing;let t=(e=>({type:"SET_PLAYING",payload:e}))(e);a.dispatch(t)}});a.subscribe(()=>{let e=a.getState();w.render(e.playing)}),E.appendChild(w.el);let _=new te({onClick:()=>{let e={type:"NEXT_TIME_INDEX"};a.dispatch(e)}});E.appendChild(_.el);m(),setInterval(m,100),new $(r,"black").fetch("./atlas/coastlines"),new $(r,"black").fetch("./atlas/borders"),new $(r,"red").fetch("./atlas/disputed"),new $(r,"LightBlue").fetch("./atlas/lakes")},$.prototype.fetch=function(e){fetch(e).then(e=>e.json()).then(e=>{this.source.data=e})},K.prototype.render=function(e){this.el.innerHTML=e},Q.prototype.render=function(e){e?(this.i.classList.remove("fas","fa-play"),this.i.classList.add("fas","fa-pause")):(this.i.classList.remove("fas","fa-pause"),this.i.classList.add("fas","fa-play"))}}]);